---
title: Npm、Yarn、Pnpm之间的区别
author: Leohoo
pubDatetime: 2022-09-22 15:11:26
slug: npm-yarn-pnpm-comparison
featured: false
draft: false
tags:
  - npm
description: 深度对比三大Node.js包管理器npm、yarn、pnpm的特点差异，详解版本控制、安装机制、性能优势和使用场景。
---

## Table of contents

## NPM

npm 是 Node.js 能够如此成功的主要原因之一。npm 团队做了很多的工作，以确保 npm 保持向后兼容，并在不同的环境中保持一致。
npm 是围绕着语义版本控制（semver）的思想而设计的
给定一个版本号：主版本号.次版本号.补丁版本号， 以下这三种情况需要增加相应的版本号:

- 主版本号： 当 API 发生改变，并与之前的版本不兼容的时候
- 次版本号： 当增加了功能，但是向后兼容的时候
- 补丁版本号： 当做了向后兼容的缺陷修复的时候

## YARN

### Yarn 是什么？

Yarn 是由 Facebook、Google、Exponent 和 Tilde 联合推出了一个新的 JS 包管理工具 ，正如官方文档中写的，”Yarn 是为了弥补 npm 的一些缺陷而出现的。”

- 使用yarn.lock文件解决那时候npm安装的不确定性（那时候npm还没有lock文件，npm5才有）
- yarn并行安装的机制比npm的顺序安装速度更快，
- 带来了可以从缓存中获取的离线模式。
- 更简洁的命令行输出
- 更好的语义化命令，比如 yarn add/remove等

```json
"5.0.3",
"~5.0.3",
"^5.0.3"
```

“5.0.3”表示安装指定的 5.0.3 版本，“～ 5.0.3”表示安装 5.0.X 中最新的版本，“^5.0.3”表示安装 5.X.X 中最新的版本。这就麻烦了，常常会出现同一个项目，有的同事是 OK 的，有的同事会由于安装的版本不一致出现 bug。

安装的时候，包会在同一时间下载和安装，中途某个时候，一个包抛出了一个错误，但是 npm 会继续下载和安装包。因为 npm 会把所有的日志输出到终端，有关错误包的错误信息就会在一大堆 npm 打印的警告中丢失掉，并且你甚至永远不会注意到实际发生的错误。

### Yarn 的优点？

- 速度快 。速度快主要来自以下两个方面：
    - 并行安装：无论 npm 还是 Yarn 在执行包的安装时，都会执行一系列任务。npm 是按照队列执行每个 package，也就是说必须要等到当前 package 安装完成之后，才能继续后面的安装。而 Yarn 是同步执行所有任务，提高了性能。
    - 离线模式：如果之前已经安装过一个软件包，用 Yarn 再次安装时之间从缓存中获取，就不用像 npm 那样再从网络下载了。
- 安装版本统一：为了防止拉取到不同的版本，Yarn 有一个锁定文件 (lock file) 记录了被确切安装上的模块的版本号。每次只要新增了一个模块，Yarn 就会创建（或更新）yarn.lock 这个文件。这么做就保证了，每一次拉取同一个项目依赖时，使用的都是一样的模块版本。npm 其实也有办法实现处处使用相同版本的 packages，但需要开发者执行 npm shrinkwrap 命令。这个命令将会生成一个锁定文件，在执行 npm install 的时候，该锁定文件会先被读取，和 Yarn 读取 yarn.lock 文件一个道理。npm 和 Yarn 两者的不同之处在于，Yarn 默认会生成这样的锁定文件，而 npm 要通过 shrinkwrap 命令生成 npm-shrinkwrap.json 文件，只有当这个文件存在的时候，packages 版本信息才会被记录和更新。
- 更简洁的输出：npm 的输出信息比较冗长。在执行 npm install 的时候，命令行里会不断地打印出所有被安装上的依赖。相比之下，Yarn 简洁太多：默认情况下，结合了 emoji 直观且直接地打印出必要的信息，也提供了一些命令供开发者查询额外的安装信息。
- 多注册来源处理：所有的依赖包，不管他被不同的库间接关联引用多少次，安装这个包时，只会从一个注册来源去装，要么是 npm 要么是 bower, 防止出现混乱不一致。
- 更好的语义化： yarn 改变了一些 npm 命令的名称，比如 yarn add/remove，感觉上比 npm 原本的 install/uninstall 要更清晰。

### Pnpm

pnpm，全称为performant npm，意为高性能的Node.js包管理器，由Zoltan Kochan 于2017 年发布，具有速度快、节省磁盘空间的特点。
